# Experiment Configuration for CounterFactual DPG - German Credit Dataset
# This file defines all parameters for running counterfactual generation experiments
# on the German Credit dataset for credit default prediction

experiment:
  name: "counterfactual_dpg_german_credit_v1"
  project: "counterfactual-dpg"  # wandb project name
  entity: "mllab-ts-universit-di-trieste"
  tags: ["baseline", "german_credit", "credit_risk"]
  notes: "Initial baseline run on German Credit dataset with default parameters"

data:
  dataset: "german_credit"
  dataset_path: "datasets/german_credit.csv"
  target_column: "default"
  test_size: 0.3
  random_state: 42
  # Feature type specifications (optional - will auto-detect if not specified)
  # continuous_features: ["duration", "amount", "installment_rate", "residence_since", "age", "existing_credits", "liable_people"]
  # categorical_features: ["status", "credit_history", "purpose", "savings", "employment_duration", "sex", "other_debtors", "property", "other_installment_plans", "housing", "job", "telephone", "foreign_worker"]
  
  # Variable features: only these features can change during counterfactual generation
  # Non-actionable (frozen): age, people_under_maintenance, credit_history, purpose, personal_status_sex, housing, foreign_worker
  variable_features:
    - account_check_status
    - duration_in_month
    - credit_amount
    - savings
    - present_emp_since
    - installment_as_income_perc
    - other_debtors
    - present_res_since
    - property
    - other_installment_plans
    - credits_this_bank
    - job
    - telephone

model:
  type: "RandomForestClassifier"
  n_estimators: 100  # More trees for this larger dataset
  random_state: 42
  max_depth: 10  # Reasonable depth for tabular data

counterfactual:
  # GA hyperparameters (from CounterFactualModel)
  diversity_weight: 0.5
  repulsion_weight: 4.0
  boundary_weight: 15.0
  distance_factor: 2.0
  sparsity_factor: 1.0
  constraints_factor: 3.0
  
  # Runtime parameters
  population_size: 40  # Larger population for more features
  max_generations: 100  # More generations for complex feature space
  mutation_rate: 0.8
  delta_threshold: 0.01
  patience: 15  # More patience for convergence
  
  # Per-feature actionability rules (preferred over legacy "rules" combinations)
  # Available rules: "none", "non_increasing", "non_decreasing", "no_change"
  # Features not listed default to "none" (no restriction)
  # Non-variable features (not in data.variable_features) are automatically "no_change"
  feature_rules:
    age: non_decreasing  # Age can only increase (cannot get younger)
  
  # Legacy: Actionability rules to test (only used if feature_rules is not set)
  # rules: ["none"]  # "non_increasing", "non_decreasing"

experiment_params:
  seed: 42
  sample_indices: null  # null = random, or list like [0, 5, 10]
  num_samples: 1  # Process 10 samples from the dataset
  num_combinations_to_test: 1  # null = test half of all combinations
  num_replications: 5
  compute_comprehensive_metrics: true  # Enable comprehensive ECE-style metrics
  parallel_replications: true  # Enable parallel execution of replications
  max_workers: null  # null = use (CPU_count - 1), or specify a number

output:
  local_dir: "experiment_results/german_credit"
  save_visualizations: true
  save_visualization_images: true
  save_raw_data: true
